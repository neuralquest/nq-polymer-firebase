<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="nq-tree.html">
<link rel="import" href="nq-home.html">
<link rel="import" href="nq-form.html">
<link rel="import" href="nq-3d-class-model.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">

<!--
`my-blank-element`
yes

@demo demo/index.html
-->

<dom-module id="nq-widgets">
    <template>

        <style include="iron-flex iron-flex-alignment iron-positioning"></style>

        <style>
            :host {
                --app-primary-color: #4285f4;
                --app-secondary-color: black;

                display: block;
                height: 100%;
                position: relative;

                background-image: linear-gradient(#CDDDE9, white);
                background-size: 20px 200px;
                background-repeat-y: no-repeat;
            }
            .overflow-y{
                overflow-y:auto;
            }
        </style>

        <app-location route="{{route}}" use-hash-as-path></app-location>
        <div class="layout vertical fit overflow-y">
            <template is="dom-repeat" items="[[widgets]]" as="widget">

                <!-- Draw widget-->
                <template is="dom-if" if="[[_typeDocument(widget.displayType)]]">
                    <div>Widget [[widget.displayType]]</div>
                </template>
                <template is="dom-if" if="[[_typeTree(widget.displayType)]]">
                    <nq-tree class="flex" level="[[level]]" view-id="[[widget.viewId]]" doc-id="[[docId]]"></nq-tree>
                    <!--<div>Widget [[widget.displayType]]</div>-->
                </template>
                <template is="dom-if" if="[[_typeTable(widget.displayType)]]">
                    <div>Widget [[widget.displayType]]</div>
                </template>
                <template is="dom-if" if="[[_type3dClassModel(widget.displayType)]]">
                    <nq-3d-class-model class="flex" level="[[level]]" view-id="[[widget.viewId]]" doc-id="[[docId]]"></nq-3d-class-model>
                </template>
                <template is="dom-if" if="[[_typeProcessModel(widget.displayType)]]">
                    <div>Widget [[widget.displayType]]</div>
                </template>
                <template is="dom-if" if="[[_typeForm(widget.displayType)]]">
                    <nq-form class="flex" level="[[level]]" view-id="[[widget.viewId]]" doc-id="[[docId]]"></nq-form>
                </template>
                <template is="dom-if" if="[[_typeHomePage(widget.displayType)]]">
                    <nq-home class="flex" level="[[level]]" view-id="[[widget.viewId]]" doc-id="[[docId]]"></nq-home>
                </template>

            </template>
        </div>
    </template>

    <script>
        Polymer({

            is: 'nq-widgets',

            properties: {
                level: Number,
                widgets: {
                    type: Array,
                    value: function() { return []; },
                    //observer: 'dataChanged'
                },
                docId: {
                    type: String,
                    computed: 'computeDocId(level, route)'
                }
            },

            _typeDocument: function(displayType) {
                return displayType==='Document';
            },
            _typeTree: function(displayType) {
                return displayType==='Tree';
            },
            _typeTable: function(displayType) {
                return displayType==='Table';
            },
            _type3dClassModel: function(displayType) {
                return displayType==='3D Class Model';
            },
            _typeProcessModel: function(displayType) {
                return displayType==='Process Model';
            },
            _typeForm: function(displayType) {
                return displayType==='Form';
            },
            _typeHomePage: function(displayType) {
                return displayType==='HomePage';
            },

            computeDocId(level, route){
                //console.log('computeDocId');
                var pathArr = route.path.split('.');
                return pathArr[level*4];
            },
            ready: function () {
                //console.log('ready widget: ', this.widget);
            }
        });
    </script>
</dom-module>